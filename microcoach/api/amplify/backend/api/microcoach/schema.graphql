# This "input" configures a global authorization rule to enable public access to
# all models in this schema. Learn more about authorization rules here: https://docs.amplify.aws/cli/graphql/authorization-rules
input AMPLIFY { globalAuthRule: AuthRule = { allow: public } } # FOR TESTING ONLY!

type Classroom @model {
  id: ID!
  learningGaps: [LearningGap] @hasMany
  students: [Student] @hasMany
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime!
}

type Student @model {
  id: ID!
  classroomId: ID!
  performanceX: String!
  performanceY: String!
  confidenceLevel: Int!
  status: String!
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime!
}

type LearningGap @model {
  id: ID!
  classroomId: ID!
  title: String
  priority: String
  studentCount: Int
  studentPercent: Int
  occurrence: String
  misconceptionSummary: String
  successIndicators: [String]
  evidence: Evidence
  move: Move
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime!
}

  type Evidence {
    source: String
    mostCommonError: String
    sampleStudentWork: [String]
    aiThinkingPattern: String
  }

  type Move {
    id: String
    title: String
    time: String
    format: String
    summary: String
    aiReasoning: String
    tabs: Tabs
  }

  type Tabs {
    overview: Overview
    activitySteps: ActivitySteps
    materials: Materials
    studentGroupings: StudentGroupings
  }

    type Overview {
      whatStudentsDo: String
      whatYouDo: String
      importance: String
    }

    type ActivitySteps {
      setup: [String]
      problem: String
      coreActivity: [String]
      discussionQuestions: [String]
    }

    type Materials {
      required: [String]
      optional: [String]
    }

    type StudentGroupings {
      groups: [StudentGroup]
      highFlyers: HighFlyers
      aiRecommendation: String
    }

      type StudentGroup {
        name: String
        description: String
        students: [String]
      }

      type HighFlyers {
        students: [String]
        description: String
      }

input GetLearningScienceInput {
  ccss: String!
}

input GetAnalyticsInput {
  classroomData: AWSJSON!
  learningScienceData: AWSJSON!
}

type Mutation {
  getLearningScience(input: GetLearningScienceInput!): String 
    @function(name: "microcoachGetLearningScience-${env}")
  getAnalytics(input: GetAnalyticsInput!): String
    @function(name: "microcoachLLM-${env}")
}